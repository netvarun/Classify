/*!
 * Classify JavaScript Library v0.9.6
 * http://www.closedinterval.com/
 *
 * Copyright 2011-2012, Wei Kin Huang
 * Classify is freely distributable under the MIT license.
 *
 * Date: Tue, 15 May 2012 19:31:25 GMT
 */;(function(a,b){"use strict";var c="prototype",d=!{toString:1}.propertyIsEnumerable("toString"),e=d?"hasOwnProperty,valueOf,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,constructor".split(","):[],f=e.length,g=Object[c],h=g.toString,i=g.hasOwnProperty,j=function(a){return typeof a=="function"},k=function(a){return a&&a[c]&&h.call(a)==="[object Function]"},l=Array.isArray||function(a){return h.call(a)==="[object Array]"},m=function(a){var b=[],c;for(c in a)b.push(c);if(d)for(c=0;c<f;c++)a.hasOwnProperty(e[c])&&b.push(e[c]);return b},n=function(a){return l(a)?a:[a]},o=function(a){return Array[c].slice.call(a,0)},p=Array[c].indexOf?function(a,b){return a.indexOf(b)}:function(a,b){var c=0,d=a.length;for(;c<d;c++)if(a[c]===b)return c;return-1},q=function(a,b){return a.__original_=b,a},r=function(a,c,d){if(!a)return a;var e,f=0,g=a.length;if(g===b||j(a)){for(e in a)if(c.call(d||a[e],a[e],e,a)===!1)break}else for(e=a[0];f<g;e=a[++f])if(c.call(d||e,e,f,a)===!1)break;return a},s=function(a,b){var c=[];return r(a,function(d,e){c[c.length]=b(d,e,a)}),c},t=function(a,b){var c=[];return r(a,function(a){a!==b&&(c[c.length]=a)}),c},u=function(){var a=o(arguments),b=a.shift();return r(a,function(a){r(m(a),function(c){b[c]=a[c]})}),b},v=/^__static_/,w=/^__observable_/,x=/^__alias_/,y=/^__nowrap_/,z=/^(?:superclass|subclass|implement|observables|extend|prototype|subclass|applicate|addProperty|removeProperty|addStaticProperty|addObservableProperty|removeObservableProperty|addAliasedProperty)$/,A="__static_",B="__observable_",C="__alias_",D="__nowrap_",E=function(){var a=function(){};return a[c].init=function(){},a.superclass=null,a.subclass=[],a.implement=[],a.observables={},a[c].constructor=E,a[c].self=E,a.__isclass_=!0,a}(),F=function(a,c){return q(function(){var d=this.parent,e;return this.parent=a,e=c.apply(this,arguments),d===b?delete this.parent:this.parent=d,e},c)},G=function(a,b,d,e){if(e===g[d])return;if(v.test(d))if(d===A)r(e,function(c,d){G(a,b,A+d,c)});else{d=d.replace(v,"");if(z.test(d))return;a[d]=j(e)&&!e.__isclass_?q(function(){return e.apply(a,arguments)},e):e}else if(w.test(d))d===B?r(e,function(c,d){G(a,b,B+d,c)}):(d=d.replace(w,""),a.observables[d]=e,r(a.subclass,function(a){i.call(a.observables,d)||a.addObservableProperty(d,e)}));else if(x.test(d))d===C?r(e,function(c,d){G(a,b,C+d,c)}):(d=d.replace(x,""),G(a,b,d,function(){return this[e].apply(this,arguments)}));else if(y.test(d))d===D?r(e,function(c,d){G(a,b,D+d,c)}):a[c][d.replace(y,"")]=e;else{var f=b[c][d],h=a[c];h[d]=j(e)&&!e.__isclass_&&j(f)?F(f,e):e,j(e)&&r(a.subclass,function(a){j(a[c][d])&&!a[c][d].__original_&&(a[c][d]=F(h[d],a[c][d]))})}},H=function(a,b){if(a[c][b]&&a[c][b]===g[b]||z.test(b.replace(v,"")))return;if(v.test(b)){b=b.replace(v,""),a[b]=null;try{delete a[b]}catch(d){}}else if(w.test(b)){b=b.replace(w,"");var e=a.observables[b];r(a.subclass,function(a){a.observables[b]===e&&a.removeObservableProperty(b)}),a.observables[b]=null;try{delete a.observables[b]}catch(d){}}else{if(!j(a[c][b])){a[c][b]=null;try{delete a[c][b]}catch(d){}return}r(a.subclass,function(a){a[c][b]&&j(a[c][b])&&j(a[c][b].__original_)&&(a[c][b]=a[c][b].__original_)}),a[c][b]=null;try{delete a[c][b]}catch(d){}}},I=function(){var a=E,d={},e=[],f=arguments,g=f.length;g===1?d=f[0]:g===2?(!f[0].__isclass_&&!k(f[0])?e=n(f[0]):a=f[0],d=f[1]):(a=f[0],e=n(f[1]),d=f[2]),!a.__isclass_&&!d.init&&(d.init=a);var h=function(){var a,c;if(!this||!this.init||!(this instanceof h))return h.invoke.apply(h,arguments);for(a in h.observables)i.call(h.observables,a)&&(this[a]=new J(this,a,h.observables[a]));c=this.init.apply(this,arguments);if(c!==b)return c};delete d.applicate,h.applicate=function(a){var b=function(){return h.apply(this,a)};return b[c]=h[c],new b},h.invoke=d.invoke||(a.invoke&&!a.invoke.__original_?a.invoke:null)||q(function(){return h.applicate(arguments)},!0),delete d.invoke,h.superclass=a,h.subclass=[],h.implement=(a.implement||[]).concat(e),h.observables=u({},a.observables||{}),h.extend=h[c].extend=function(){return I.apply(null,[h].concat(o(arguments)))};var l=function(){};l[c]=a[c];var p=l[c];return h[c]=new l,a.subclass&&a.subclass.push(h),d.invoke=function(a,b){if(a in p&&a!=="invoke"&&j(p[a])){var c=this.invoke,d;return this.invoke=p.invoke,d=p[a].apply(this,b||[]),this.invoke=c,d}throw Error('Function "'+a+'" of parent class being invoked is undefined.')},h.addProperty=function(a,c,d){return d=d||"",c===b?r(m(a),function(b){G(h,l,d+b,a[b])}):G(h,l,d+a,c),h},h.removeProperty=function(a){return H(h,a),h},h.addStaticProperty=function(a,b){return h.addProperty(a,b,A)},h.removeStaticProperty=function(a){return h.removeProperty(A+a)},h.addObservableProperty=function(a,b){return h.addProperty(a,b,B)},h.removeObservableProperty=function(a){return h.removeProperty(B+a)},h.addAliasedProperty=function(a,b){return h.addProperty(a,b,C)},h.addUnwrappedProperty=function(a,b){return h.addProperty(a,b,D)},e.length!==0&&r(e,function(a){var e=a.__isclass_?a[c]:a;r(m(e),function(a){h[c][a]===b&&d[a]===b&&h.addProperty(a,e[a])})}),h.addProperty(d),h[c].constructor=h,h[c].self=h,h.__isclass_=!0,h},J=I({init:function(a,b,c){if(!a)throw Error("Cannot create Observer without class context.");this.context=a,this.name=b,this.events=[],this.writable=!0,this.delay=0,this._debounce=null,c!==null&&typeof c=="object"?(this.getter=j(c.get)?c.get:null,this.setter=j(c.set)?c.set:null,this.value=c.value,this.writable=typeof c.writable=="boolean"?c.writable:!0,this.delay=typeof c.delay=="number"?c.delay:0):this.value=c},get:function(){return this.getter?this.getter.call(this.context,this.value):this.value},set:function(a){var b=this.value;return this.writable?(this.value=this.setter?this.setter.call(this.context,a,b):a,this.value!==b&&this.emit(),this.context):this.context},emit:function(){var b=this;return this.delay>0?(this._debounce!==null&&a.clearTimeout(this._debounce),this._debounce=a.setTimeout(function(){this._debounce=null,b.triggerEmit()},this.delay)):this.triggerEmit(),this.context},triggerEmit:function(){var a=0,b=this.events.length;for(;a<b;a++)this.events[a].call(this.context,this.value)},addListener:function(a){if(!j(a))throw Error("Observer.addListener only takes instances of Function");return this.events.push(a),this.context},removeListener:function(a){if(!j(a))throw Error("Observer.removeListener only takes instances of Function");var b=p(this.events,a);return b<0?this.context:(this.events.splice(b,1),this.context)},removeAllListeners:function(){return this.events=null,this.events=[],this.context},listeners:function(){return this.events},toValue:function(){return this.value&&this.value.toValue?this.value.toValue():this.value},toString:function(){return"[observer "+this.name+"]"}}),K={},L="GLOBAL",M,N,O,P,Q=function(a,b){return r(a,function(a){b[a]||(b[a]={}),b=b[a]}),b},R=function(a,b,c){if(typeof b=="string"){c=a[b]||P().get(b)||null;if(!c)throw Error("Invalid parent class ["+b+"] specified.");return c}return l(b)?s(b,function(b){return R(a,b)}):b},S=I({init:function(a){this.ref={},this.name=a},create:function(){var a=o(arguments),b=a.shift(),d=b.split("."),e=d.pop(),f=this,g=Q(d,f),h=f.ref,i=I.apply(null,s(a,function(a){return R(h,a)}));return i._name_=e,i._namespace_=b,i.extend=i[c].extend=function(){return I.apply(null,[i].concat(s(arguments,function(a){return R(h,a)})))},i.getNamespace=function(){return f},i.toString=function(){return"[object "+b+"]"},g[e]=i,h[b]=i,i},destroy:function(a){var b,c=a.split("."),d=c.pop(),e=this,f=this,g=this.ref;return r(c,function(a){if(!f[a])return f=null,!1;f=f[a]}),f?(b=f[d],b?(r(b.subclass,function(a){e.destroy(a._namespace_)}),b.superclass.subclass&&(b.superclass.subclass=t(b.superclass.subclass,b)),r(g,function(b,c){c!==a&&c.indexOf(a)===0&&e.destroy(b._namespace_)}),delete f[d],delete g[a],this):this):this},exists:function(a){return!!this.ref[a]},get:function(a,b){return j(b)?(this.ref[a]?b(this.ref[a]):this.load(a,b),this):this.ref[a]||this.name!==L&&P().get(a)||null},load:function(a,b){return b&&b(this.ref[a]||null),this},setAutoloader:function(a){if(!j(a))throw Error("Namespace.setAutoloader only takes instances of Function");return this.load=a,this},getName:function(){return this.name},toString:function(){return"[namespace "+this.name+"]"}});M=function(a){return a instanceof S?a:(a=a||L,K[a]||(K[a]=new S(a)),K[a])},N=function(a){a instanceof S&&(a=a.name);if(a===L)return;delete K[a]},O=function(a){var b=a.split("."),c=b.length,d;while((d=b.slice(0,c--).join("."))!=="")if(K[d])return K[d];return null},P=function(){return M(L)};var T="/",U=I({invoke:function(){var a=o(arguments),b=a.length,c,d;if(b===0)return M();if(typeof a[0]=="string")return b===1?(d=a[0].split(T),c=M(d[0]),d[1]?c.get(d[1]):c):b===2&&typeof a[1]=="string"?M(a[0]).get(a[1]):(d=a.shift().split(T),c=M(d[0]),d[1]&&a.unshift(d[1]),c.create.apply(c,a));return I.apply(null,a)},init:function(){var a=o(arguments),b,c;if(a.length<1)throw Error("Classify object cannot be instantiated!");return b=l(a[a.length-1])?a.pop():[],c=U.invoke.apply(null,a),c.__isclass_?c.applicate(b):c}});u(U,{version:"0.9.6",create:I,Namespace:S,getNamespace:M,destroyNamespace:N,testNamespace:O,getGlobalNamespace:P,Observer:J,extend:u,provide:function(b,c){return Q(b.split("."),c||a||{})}});if(typeof a.module!="undefined"&&a.module.exports)a.module.exports=U,U.Classify=U;else if(typeof a.define=="function"&&a.define.amd)a.define("classify",function(){return U});else{var V=a.Classify;a.Classify=U,U.noConflict=function(){return V===b?delete a.Classify:a.Classify=V,U}}})(this);